<?php

declare(strict_types=1);

namespace App\DataFixtures;

use App\Entity\ConstructionImplementation;
use App\Entity\Project;
use Doctrine\Bundle\FixturesBundle\Fixture;
use Doctrine\Common\DataFixtures\DependentFixtureInterface;
use Doctrine\Persistence\ObjectManager;

class ConstructionImplementationFixtures extends Fixture implements DependentFixtureInterface
{
    public function getDependencies(): array
    {
        return [
            ConstructionPreparationFixtures::class,
        ];
    }

    public function load(ObjectManager $manager): void
    {
        $projectRepo = $manager->getRepository(Project::class);

        // Define construction implementations for all 10 projects
        $constructionImplementations = [
            [
                'projectName' => '智慧城市数据平台建设项目',
                'startDate' => '2026-03-16',
                'completionDate' => '2026-11-15',
                'constructionProgressDetails' => '项目已完成65%。第一阶段机房建设和硬件采购已完成，IDC机房通过验收，服务器、存储设备、网络设备已全部到货并安装调试完成。第二阶段软件平台开发进展顺利，已完成数据采集模块、数据存储模块、数据分析模块的开发和测试，目前正在进行数据可视化模块开发。第三阶段系统集成工作已启动，正在进行各子系统的接口联调。按照计划，10月底完成全部开发工作，11月进行试运行和验收。',
                'qualityInspectionDetails' => '机房建设质量验收合格，防雷接地、消防系统、空调系统、UPS供电系统均符合A级机房标准。硬件设备开箱检验全部合格，性能测试达到技术要求。软件开发采用代码审查机制，每个模块通过单元测试、集成测试后才进入下一阶段。数据采集准确率达99.8%，数据存储可靠性达99.99%。系统响应时间、并发处理能力等性能指标均满足设计要求。第三方测试机构已完成两次阶段性质量检测，结论为优良。',
                'safetyInspectionDetails' => '信息安全管理严格落实。通过公安部信息系统安全等级保护三级测评。部署了防火墙、入侵检测系统、漏洞扫描系统。每月进行一次安全漏洞扫描，发现问题及时整改。进行了两次渗透测试，未发现高危漏洞。数据库采用加密存储，网络传输采用SSL加密。建立了7×24小时安全监控机制。施工期间机房用电安全检查10次，均符合规范。应急演练3次,应急响应能力良好。',
                'progressPaymentDetails' => '合同总价498万元。首期款已按合同约定支付30%计149.4万元。第二期款已于7月底支付，按完成工作量50%支付40%计199.2万元，累计已支付348.6万元，占合同总价70%。第三期款将在项目验收合格后支付25%计124.5万元。质保金5%计24.9万元在质保期满后支付。各期付款均经过严格的验收和审核程序，付款凭证齐全。',
                'changeOrderDetails' => '施工过程中发生3次变更。变更一：增加数据备份系统容量，由原计划50TB增加到100TB，增加费用18万元。变更二：增加移动端APP功能模块，增加费用25万元。变更三：机房UPS容量由200KVA提升到300KVA，增加费用12万元。所有变更均履行了审批程序，经建设单位、设计单位、监理单位签字确认，变更费用合计55万元，调整后合同总价为553万元。',
                'supervisionDetails' => '监理单位为北京中科建设监理有限公司，派驻总监1名、专业监理工程师3名。监理工作到位，坚持旁站监理制度，关键工序100%旁站。每周召开监理例会，协调解决施工中的问题。累计发出监理通知12份，施工单位整改及时。编制监理月报8份，详细记录工程进度、质量、安全情况。对3次变更进行了认真审核，确保变更合理合规。监理工作得到建设单位和施工单位的一致好评。',
            ],
            [
                'projectName' => '东城区市政道路改造工程',
                'startDate' => '2026-04-11',
                'completionDate' => '2026-11-10',
                'constructionProgressDetails' => '项目已完成5个施工段中的2个,累计完成6公里道路改造,占总工程量的40%。第一、二施工段旧路面铣刨、基层处理、新路面铺设、人行道铺装、绿化带恢复已全部完成并恢复交通。第三施工段正在进行路面铺设,预计9月底完成。第四、五施工段正在进行旧路面铣刨和基层处理。附属设施如路灯、交通标志标线、雨水篦子等同步安装。按照施工进度计划，11月初可完成全部工程。',
                'qualityInspectionDetails' => '已完成路段质量检测结果优良。路面压实度达到96%以上，超过规范要求的95%。平整度控制在3mm以内，达到优良标准。路面厚度抽检合格率100%。基层强度、路面抗滑性能等指标均满足设计要求。沥青混凝土配合比试验合格，原材料检验合格率100%。隐蔽工程验收资料齐全，雨水管道闭水试验全部合格。市质监站已进行两次监督检查,评价为优良工程。第三方检测机构已完成3次阶段性质量检测。',
                'safetyInspectionDetails' => '施工期间未发生安全事故,实现安全生产零事故目标。每日班前安全教育,施工人员安全意识强。交通导改科学合理,施工期间未发生交通事故。施工现场设置安全警示标志135处,防护设施完善。夜间施工照明充足,反光标识醒目。深基坑作业严格执行支护方案,边坡稳定。机械设备定期维护保养,操作人员持证上岗。市安监站检查5次,均为合格。应急预案完善,应急演练3次。',
                'progressPaymentDetails' => '合同总价1185万元。已按工程进度拨付工程款710万元,占合同总价60%。其中首期款已支付30%计355.5万元,第二期按40%完成进度支付40%计474万元。累计完成产值约750万元,计量支付及时。第三期款将在全部工程完成后支付25%计296.25万元。质保金5%计59.25万元在质保期2年满后支付。付款手续完备,无拖欠工程款情况。',
                'changeOrderDetails' => '施工中发生2次变更签证。变更一：局部路段因地下管线复杂需调整开挖方案,增加支护费用8.5万元。签证一：开挖过程中发现废弃人防工程,需额外处理,增加费用15万元。变更签证均按程序审批,经建设单位、设计单位、监理单位、施工单位四方签字确认。变更签证费用合计23.5万元,调整后合同价1208.5万元。现场签证资料齐全,计量准确。',
                'supervisionDetails' => '监理单位为北京市政工程监理有限公司,派驻总监理工程师1名、专业监理工程师4名、监理员2名。监理人员到岗到位,认真履行监理职责。坚持每日巡视,关键工序旁站监理。每周召开工地例会,协调解决工程问题。累计发出监理工程师通知15份,已全部整改完成。审核施工组织设计、专项施工方案8份。编制监理月报7份,监理工作日志详细完整。监理工作规范,质量控制严格,得到各方认可。',
            ],
            [
                'projectName' => '企业园区智能安防系统',
                'startDate' => '2026-03-11',
                'completionDate' => '2026-09-10',
                'constructionProgressDetails' => '项目已完成80%。现场勘察和点位确认已完成，确定安装摄像头320个、门禁点68个、报警探测器156个。设备采购已完成，所有设备到货并通过开箱检验。管线施工已全部完成，共布设线缆28000米。摄像头安装完成300个，门禁安装完成60个，报警系统安装完成140个。监控中心已建成投用，配备30块拼接屏、2套管理工作站。系统调试完成75%，已完成区域的系统运行稳定。预计9月初完成全部安装调试工作。',
                'qualityInspectionDetails' => '所有设备均为海康威视原厂正品，提供原厂质保承诺和产品合格证。设备开箱检验合格率100%。点位布置科学合理，监控覆盖率达98%，无明显盲区。摄像头安装牢固，画面清晰度达到高清1080P标准，夜间红外效果良好。门禁系统响应速度快，识别准确率99.5%。报警系统灵敏可靠。网络系统稳定，视频传输流畅不卡顿。已完成区域试运行一个月，系统稳定运行，故障率低于1%。',
                'safetyInspectionDetails' => '施工期间未发生安全事故。施工人员均持有电工证等相关资质。高空作业严格执行安全操作规程，使用安全带、安全帽等防护用品。机房施工严格执行用电安全规范，配备灭火器、消防沙等消防设施。管线施工设置安全警戒区，非施工人员禁止入内。用电设备定期检查，无违规用电现象。安全检查8次，均符合安全要求。信息安全管理到位，施工人员签订保密协议。',
                'progressPaymentDetails' => '合同总价348万元。已按合同约定支付工程款278.4万元，占合同总价80%。首期款30%计104.4万元在合同签订后支付。第二期款30%计104.4万元在设备到货后支付。第三期款30%计104.4万元在系统调试完成75%后支付。第四期款10%计34.8万元将在验收合格后支付。各期付款均经过严格验收，付款凭证齐全，无拖欠工程款。',
                'changeOrderDetails' => '施工中发生4次变更。变更一：根据实际需求增加摄像头20个，增加费用4.8万元。变更二：增加人脸识别门禁点8个，增加费用6.5万元。变更三：监控中心增加4块拼接屏，增加费用3.2万元。变更四：增加周界报警系统200米，增加费用2.5万元。所有变更均经过建设单位审批，费用合计17万元，调整后合同总价365万元。变更资料齐全，手续完备。',
                'supervisionDetails' => '监理单位为上海市信息工程监理有限公司，派驻总监1名、专业监理工程师2名。监理工作认真负责，严格把关设备质量和施工质量。设备到货检验全程参与，不合格设备坚决退换。关键工序旁站监理，施工过程严格按规范执行。每周召开工地例会，协调解决技术问题。累计发出监理通知8份，整改及时。审核专项施工方案5份，提出合理化建议多项。编制监理月报6份，监理日志详细完整。监理工作得到建设单位好评。',
            ],
            [
                'projectName' => '水利枢纽工程建设',
                'startDate' => '2026-06-16',
                'completionDate' => '2027-12-15',
                'constructionProgressDetails' => '项目进入主体施工阶段，已完成15%。导流工程已完成，围堰施工质量良好，度过首个汛期考验。基础开挖完成土石方320万立方米，占总量的45%。主坝基础处理进展顺利，已完成帷幕灌浆2.8万米、固结灌浆1.5万米。混凝土浇筑累计完成8.2万立方米，占总量的12%。泄洪洞开挖累计完成1200米，占总长的60%。施工高峰期投入人员1800人、各类机械设备230台套。按照计划安排，预计2027年12月主体工程完工。',
                'qualityInspectionDetails' => '工程质量管理严格，质量总体优良。混凝土原材料检验合格率100%，配合比试验符合设计要求。混凝土浇筑温控措施到位，温度监测数据正常，未出现有害裂缝。混凝土强度检测合格率100%，28天强度达到设计要求的105%以上。帷幕灌浆、固结灌浆压水试验合格率98%以上。地质缺陷处理经专家论证，处理效果良好。隐蔽工程验收资料完整，重要部位进行了无损检测。质监站检查6次，评价为优良。第三方检测机构完成4次质量检测，质量可控。',
                'safetyInspectionDetails' => '工程安全管理规范，未发生等级安全事故，实现安全生产1200天。建立健全安全管理制度，项目经理为安全第一责任人，配备专职安全员15名。高边坡防护措施到位，设置防护网、警示标志，定期监测边坡稳定性。深基坑作业严格按照专项方案施工，基坑支护稳定可靠。大型设备如塔吊、门机定期检测维护，操作人员持证上岗。汛期防汛措施完善，24小时值班。应急预案完善，组织应急演练5次。安监部门检查8次，均为合格。',
                'progressPaymentDetails' => '合同总价7.85亿元。已按月进度拨付工程款1.57亿元，占合同总价20%。付款严格按照计量支付程序，每月根据完成工作量计量，经监理审核、建设单位批准后支付。已完成土石方开挖、基础处理、混凝土浇筑等产值约1.75亿元。计量支付及时，资金到位率90%。合同约定留10%质保金，质保期3年。各期计量支付资料齐全，台账清晰，无拖欠工程款和农民工工资情况。',
                'changeOrderDetails' => '施工中发生8次重大变更和签证。主要变更包括：基础处理方案优化，由于地质条件复杂，帷幕灌浆深度增加，增加费用1200万元；泄洪洞开挖支护方案调整，增加锚杆和喷混凝土，增加费用850万元；混凝土配合比优化，增加掺合料，增加费用420万元；导流工程度汛加固，增加费用650万元。所有变更均经过专家论证、设计单位同意、建设单位批准。变更费用合计约4500万元，调整后合同价约8.3亿元。变更资料完整，手续齐全。',
                'supervisionDetails' => '监理单位为中国水利水电建设监理公司，派驻总监1名、副总监2名、专业监理工程师15名、监理员30名。监理机构健全，人员到位，监理工作规范。实行24小时旁站监理制度，关键部位、关键工序100%旁站。每周召开工程例会，每月召开监理月会，协调解决工程问题。累计发出监理工程师通知68份、监理工程师指令12份，整改及时有效。审核专项施工方案35份，组织专家论证8次。编制监理月报6份、监理大事记完整。监理工作得到质监、安监等部门好评。',
            ],
            [
                'projectName' => '商业综合体建筑工程',
                'startDate' => '2026-06-21',
                'completionDate' => '2028-06-20',
                'constructionProgressDetails' => '项目进入主体施工阶段，已完成20%。地下室结构已全部完成，通过结构验收。主体结构施工至地上15层，占总层数的50%。地下室防水工程完成并通过蓄水试验。幕墙工程已开始，完成样板段，正在大面积施工。机电安装工程已进场，配合土建进行预留预埋。电梯井道、管道井施工同步进行。施工高峰期投入管理人员80人、劳务人员800人、各类机械设备35台。采用BIM技术进行施工管理，建立三维模型，优化施工方案。按计划2028年6月竣工。',
                'qualityInspectionDetails' => '工程质量优良，向鲁班奖目标迈进。原材料检验严格，钢筋、混凝土、幕墙材料等合格率100%。混凝土强度检测合格率100%，实体强度达到设计要求的110%以上。钢筋连接采用机械连接，接头质量检测合格率98%以上。模板工程样板先行，几何尺寸控制精确。地下室防水采用多道防水，蓄水试验无渗漏。主体结构垂直度、平整度控制优良，达到创优标准。质监站检查7次，评价为优良工程。成立质量攻关小组，解决质量难题15项。',
                'safetyInspectionDetails' => '安全管理规范，未发生安全事故，实现安全生产目标。建立三级安全管理体系，各级安全责任明确。深基坑支护经专家论证，基坑监测数据正常，变形在控制范围内。高支模架体经专家论证，搭设规范，验收合格后使用。脚手架搭设规范，验收合格，定期检查维护。塔吊、施工电梯定期检测，安全装置齐全有效，操作人员持证上岗。施工现场封闭管理，人员进出实名制。安全检查每周进行，隐患及时整改。应急演练4次，应急能力良好。安监站检查7次，均为合格。',
                'progressPaymentDetails' => '合同总价2.45亿元。已按月进度拨付工程款5390万元，占合同总价22%。付款严格按照进度拨付，每月根据完成工程量计量，经监理审核、建设单位审批后支付。已完成产值约5700万元，包括地下室工程、主体结构工程。计量支付及时准确，资金到位率95%。合同约定留5%质保金，质保期2年。各期计量支付手续完备，无拖欠工程款和农民工工资。建立农民工工资专户，工资按月足额发放。',
                'changeOrderDetails' => '施工中发生多次变更。主要变更包括：地下室底板加厚，由于地质情况需要，底板由0.8米增加到1.2米，增加费用180万元；幕墙材料品牌调整，应业主要求，幕墙玻璃品牌升级，增加费用350万元；机电系统优化，中央空调系统采用更节能的品牌，增加费用280万元；精装修标准提升，部分材料品牌升级，增加费用420万元。所有变更均履行审批程序，费用合计约1600万元。调整后合同价约2.61亿元。变更资料完整。',
                'supervisionDetails' => '监理单位为中国建设监理公司，派驻总监1名、副总监1名、专业监理工程师8名、监理员12名。监理队伍专业齐全，涵盖土建、幕墙、机电等专业。监理工作规范，严格履行监理职责。关键部位、关键工序实行旁站监理。每周召开工程例会，每月召开专题会议，协调解决工程问题。累计发出监理工程师通知45份、监理工程师指令8份，整改及时。审核施工组织设计和专项方案28份。编制监理月报6份，监理日志详细。监理工作得到建设单位和质监站好评。',
            ],
            [
                'projectName' => '环境治理信息化平台',
                'startDate' => '2026-03-26',
                'completionDate' => '2027-03-25',
                'constructionProgressDetails' => '项目已完成50%。第一阶段监测设备采购已完成，采购大气监测站15座、水质监测站10座、噪声监测点30个、视频监控点50个，设备通过验收。第二阶段设备安装和网络建设已完成80%，已安装大气站12座、水质站8座、噪声点25个、视频点45个，4G/5G网络覆盖良好。第三阶段数据中心建设完成，机房设备安装调试完毕。软件平台开发完成60%，数据采集、存储、分析模块已完成，正在进行数据展示和报警模块开发。预计明年3月完成全部工作。',
                'qualityInspectionDetails' => '监测设备全部通过国家环境监测仪器质量监督检验中心检验，提供CMA检测报告和计量检定证书。设备安装严格按照技术规范实施，点位选择科学合理。设备运行稳定，数据采集准确可靠。已安装监测点试运行3个月，与人工监测数据比对，误差在允许范围内，准确率达98%以上。网络传输稳定，数据上传成功率99.5%以上。软件平台功能测试通过，界面友好，操作便捷。数据库性能测试达标，支持海量数据存储和快速查询。',
                'safetyInspectionDetails' => '施工安全管理到位，未发生安全事故。监测站点安装施工注意用电安全，配备漏电保护器。高处作业采取安全措施，使用安全带、安全帽。设备安装现场设置警示标志。数据中心机房建设严格执行规范，配备气体灭火系统、UPS电源、精密空调。信息系统安全按照等级保护二级要求实施，部署防火墙、入侵检测系统。进行了安全漏洞扫描和渗透测试，未发现高危漏洞。建立应急预案，进行应急演练2次。安全检查6次，均符合要求。',
                'progressPaymentDetails' => '合同总价415万元。已按项目进度支付工程款249万元，占合同总价60%。首期款20%计83万元在合同签订后支付。第二期款30%计124.5万元在设备采购完成后支付。第三期款30%计124.5万元在安装调试完成80%后支付，已支付99.6万元（按80%比例）。第四期款15%计62.25万元将在验收合格后支付。质保金5%计20.75万元在质保期3年满后支付。各期付款经过严格验收审核，凭证齐全，无拖欠。',
                'changeOrderDetails' => '施工中发生5次变更。变更一：增加大气监测站3座，覆盖重点工业区，增加费用36万元。变更二：水质监测站增加重金属检测功能，增加费用28万元。变更三：增加移动监测车1辆，增加费用45万元。变更四：数据中心存储容量扩容，由50TB增加到100TB，增加费用15万元。变更五：软件平台增加移动APP和微信小程序，增加费用22万元。所有变更均经环保局审批，费用合计146万元，调整后合同价561万元。',
                'supervisionDetails' => '监理单位为浙江省环境工程监理中心，派驻总监1名、专业监理工程师2名。监理人员专业能力强，熟悉环境监测技术规范。监理工作认真负责，严格把关设备质量和施工质量。设备到货检验全程参与，检查设备合格证、检定证书。设备安装过程监督，确保安装规范。每周召开工地例会，协调解决技术问题。累计发出监理通知10份，整改及时有效。审核专项施工方案6份，提出合理化建议。编制监理月报6份，监理工作日志完整。监理工作得到环保局认可。',
            ],
            [
                'projectName' => '高速公路交通工程',
                'startDate' => '2026-08-16',
                'completionDate' => '2029-08-15',
                'constructionProgressDetails' => '项目已全面开工建设，已完成5%。施工准备工作全部完成，临时设施建设完成，8个施工队伍全部进场。路基工程开工，完成土石方开挖填筑180万立方米，占总量的8%。桥梁工程开工，完成桥梁桩基620根，占总量的15%。隧道工程开工，累计开挖850米，占总长的12%。路面基层尚未开始施工。交通工程、绿化工程待主体工程完成后实施。施工高峰期投入人员5000人、各类机械设备650台套。按照三年工期安排，目前进度正常。',
                'qualityInspectionDetails' => '质量管理体系健全，试验室通过验收。原材料检验严格，土、砂、石、水泥、钢筋等材料合格率100%。路基工程压实度检测合格率98%以上，达到设计要求。桥梁桩基采用超声波检测，一类桩占比92%，二类桩占比8%，无三类桩，质量优良。混凝土强度检测合格率100%。隧道开挖严格按照新奥法施工，支护及时，变形监测正常。首件工程制度落实，路基、桥涵首件工程经验收合格后推广。质监站检查3次，评价为优良。',
                'safetyInspectionDetails' => '安全管理规范，未发生等级安全事故，实现安全生产180天。建立健全安全生产责任制，各级责任明确。高边坡防护到位，设置主动防护网、被动防护网，边坡监测数据正常。桥梁施工设置安全防护，高空作业采取安全措施。隧道施工严格执行安全专项方案，配备通风、照明、监测设备，制定瓦斯、突泥突水等应急预案。大型机械定期检测，操作人员持证上岗。施工便道设置安全标志，限速行驶。安全检查每周进行，隐患台账管理。应急演练3次。安监部门检查4次，均为合格。',
                'progressPaymentDetails' => '合同总价44.5亿元，采用单价合同，按实际工程量结算。已按月进度拨付工程款2.67亿元，占合同总价6%。付款严格按照计量支付程序，每月根据完成工作量计量，经监理审核、建设单位批准后支付。已完成路基、桥梁、隧道等产值约2.9亿元。计量支付及时准确，资金到位率92%。合同约定留10%质保金，质保期3年。各期计量资料齐全，台账清晰。无拖欠工程款和农民工工资，农民工工资实行实名制发放。',
                'changeOrderDetails' => '施工中已发生变更和签证。主要包括：局部路基边坡滑塌处理，增加抗滑桩和锚索，增加费用850万元；隧道地质条件复杂，支护参数加强，增加费用1200万元；桥梁基础遇到孤石，处理费用增加480万元；征地拆迁范围内增加坟墓迁移，费用320万元。所有变更签证均按程序审批，经设计单位同意、监理单位审核、建设单位批准。变更签证费用目前合计约3200万元。变更资料完整，手续齐全，计量准确。',
                'supervisionDetails' => '监理单位为山东省公路工程监理公司，派驻总监1名、副总监2名、驻地监理工程师8名、专业监理工程师25名、监理员40名。监理队伍人员素质高，经验丰富。监理机构健全，分设路基、桥梁、隧道、路面等专业组。监理工作规范，严格执行旁站监理制度。每周召开工程例会，每月召开监理月会。累计发出监理工程师通知28份、监理工程师指令5份，整改及时。审核专项施工方案18份，组织首件工程验收3次。编制监理月报3份，监理工作得到业主和质监站好评。',
            ],
            [
                'projectName' => '智慧医疗信息系统升级',
                'startDate' => '2026-04-06',
                'completionDate' => '2027-04-05',
                'constructionProgressDetails' => '项目已完成45%。第一阶段需求调研已完成，访谈医护人员300余人次，收集需求500余条，完成需求分析和系统设计，通过专家评审。第二阶段软件开发顺利进行，完成了电子病历系统、医嘱管理系统、护理管理系统、检验系统接口、影像系统接口等核心模块的开发和测试。第三阶段系统集成和接口调试已启动，已完成HIS、LIS、PACS等系统的接口联调。第四阶段试点医院部署即将开始，选择2家医院作为试点。按计划明年4月完成全部工作。',
                'qualityInspectionDetails' => '软件开发严格按照CMMI5标准执行，质量管理规范。需求分析充分，系统设计合理，通过专家评审。代码开发采用敏捷方式，每个迭代进行代码审查和单元测试，代码覆盖率达85%以上。集成测试充分，接口联调成功率98%。性能测试达标，系统响应时间小于3秒，并发用户数支持2000人以上。安全测试通过，漏洞扫描未发现高危漏洞。数据迁移测试成功，数据准确率100%。第三方测试机构完成2次阶段性测试，评价为优良。',
                'safetyInspectionDetails' => '信息安全管理严格规范。系统设计符合等级保护三级要求，通过安全评测。部署了防火墙、入侵检测系统、数据库审计系统、堡垒机等安全设备。应用系统采用身份认证、权限控制、日志审计等安全措施。医疗数据采用加密存储和传输，符合《网络安全法》和《数据安全法》要求。进行了安全漏洞扫描，发现问题及时整改。进行了渗透测试，未发现高危漏洞。建立了应急预案，进行应急演练2次。信息安全检查5次，均为合格。',
                'progressPaymentDetails' => '合同总价675万元。已按项目进度支付工程款337.5万元，占合同总价50%。首期款20%计135万元在合同签订后支付。第二期款30%计202.5万元在软件开发完成50%后支付。第三期款正在办理，按完成进度应支付30%计202.5万元，目前已支付50%计101.25万元。第四期款15%计101.25万元将在验收合格后支付。质保金5%计33.75万元在质保期3年满后支付。各期付款经过验收，凭证齐全。',
                'changeOrderDetails' => '项目实施中发生6次变更。变更一：增加移动医护系统，支持医护人员使用平板和手机办公，增加费用45万元。变更二：增加患者自助服务系统，包括自助挂号、缴费、打印，增加费用38万元。变更三：增加远程会诊系统，支持与上级医院远程会诊，增加费用52万元。变更四：增加医疗大数据分析平台，增加费用68万元。变更五：系统服务器配置提升，增加费用25万元。变更六：增加系统培训场次，增加费用12万元。变更费用合计240万元，调整后合同价915万元。',
                'supervisionDetails' => '监理单位为四川省信息工程监理中心，派驻总监1名、专业监理工程师3名。监理人员熟悉医疗信息化，专业能力强。监理工作认真负责，参与需求评审、设计评审、代码审查、测试验收等各个环节。每两周召开工地例会，协调解决技术问题。累计发出监理通知12份，提出问题和建议多项，整改及时有效。审核项目实施方案、测试方案等文档8份。编制监理月报6份，监理日志详细完整。监理工作得到医院和卫健委认可。',
            ],
            [
                'projectName' => '产业园区基础设施建设',
                'startDate' => '2026-07-11',
                'completionDate' => '2027-07-10',
                'constructionProgressDetails' => '项目已完成30%。道路工程完成路基施工5公里，占总长的50%，已完成道路基层2公里，正在进行路面面层施工。给水工程完成管道铺设3.5公里，占总长的35%。排水工程完成雨水管道4公里、污水管道3.5公里，占总长的38%。电力工程完成电缆沟开挖5公里，电缆敷设2公里。通信工程完成管道铺设3公里。绿化工程尚未开始。各专业施工相互配合，总体进度正常。按照12个月工期，预计明年7月完工。',
                'qualityInspectionDetails' => '质量管理严格，工程质量优良。道路工程路基压实度达到96%以上，超过设计要求。基层强度达到设计要求，平整度控制良好。管网工程严格控制标高、坡度，闭水试验合格率100%。给水管道试压合格，无渗漏。电力电缆采用优质产品，绝缘测试合格。隐蔽工程验收资料完整，验收合格后才覆土。原材料检验严格，合格率100%。市质监站检查4次，评价为优良。第三方检测机构完成3次检测，质量可控。',
                'safetyInspectionDetails' => '安全管理到位，未发生安全事故，实现安全生产240天。建立安全生产责任制，项目经理为第一责任人，配备专职安全员。施工现场设置围挡和安全警示标志。深基坑、管线施工设置安全防护，防止人员坠落。起重作业严格管理，起重机械定期检测，操作人员持证上岗。施工用电规范，配备漏电保护装置。交叉施工加强协调，防止相互干扰。安全教育培训全覆盖，新进场人员必须培训。安全检查每周进行，隐患及时整改。应急演练3次。安监站检查4次，均为合格。',
                'progressPaymentDetails' => '合同总价3450万元。已按月进度拨付工程款1207.5万元，占合同总价35%。付款按照工程进度，每月根据完成工程量计量，经监理审核、建设单位审批后支付。已完成道路、管网、电力等工程产值约1280万元。计量支付及时准确，资金到位率94%。合同约定留5%质保金，质保期2年。各期计量支付资料完整，台账清晰。无拖欠工程款和农民工工资情况，农民工工资按月足额发放。',
                'changeOrderDetails' => '施工中发生变更和签证。主要包括：道路局部路段因地下管线复杂需调整线位，增加工程量，增加费用45万元；排水管道局部调整管径，由DN600增加到DN800，增加费用28万元；增加路灯180盏，增加费用36万元；绿化面积增加8000平方米，增加费用52万元；电力电缆由铜芯改为铝合金，减少费用15万元。变更签证费用净增加146万元，调整后合同价3596万元。所有变更签证按程序审批，资料齐全。',
                'supervisionDetails' => '监理单位为湖北省建设监理公司，派驻总监1名、专业监理工程师4名、监理员2名。监理队伍专业齐全，涵盖道路、给排水、电力、绿化等专业。监理工作认真负责，严格履行监理职责。坚持每日巡视，关键工序旁站监理。每周召开工地例会，协调解决工程问题。累计发出监理工程师通知18份，已全部整改完成。审核施工组织设计和专项施工方案10份。编制监理月报6份，监理日志详细完整。监理工作规范，质量控制严格，得到建设单位好评。',
            ],
            [
                'projectName' => '轨道交通信号系统改造',
                'startDate' => '2026-05-21',
                'completionDate' => '2027-05-20',
                'constructionProgressDetails' => '项目已完成40%。共需改造3条线路、36个车站。1号线改造已完成，12个车站全部完成设备更换和系统调试，已投入运营，运行稳定。2号线改造进行中，已完成8个车站，正在进行第9、10车站的施工，预计年底完成。3号线改造计划明年上半年实施。施工严格遵守运营时间安排，在夜间和周末进行，不影响白天正常运营。每个车站改造工期约2周，施工组织紧凑高效。按照12个月工期，预计明年5月全部完成。',
                'qualityInspectionDetails' => '信号系统质量可靠，安全性能优良。所有设备通过国铁集团型式试验和安全认证，符合轨道交通信号系统标准。设备到货检验严格，合格率100%。设备安装严格按照技术规范和图纸实施，安装质量优良。系统调试充分，各项参数满足设计要求，功能测试、性能测试、安全测试全部通过。联调联试覆盖各种运行场景，包括正常运行、故障处理、应急情况等。已完成线路试运行稳定，无故障。第三方安全评估通过，评价为优良。行业主管部门验收通过。',
                'safetyInspectionDetails' => '施工安全管理严格，未发生安全事故，确保运营安全。制定详细施工安全方案和应急预案，通过专家评审。施工人员经过地铁运营安全培训，熟悉运营规章制度。施工区域设置隔离防护，防止影响运营区域。旧系统拆除和新系统安装严格按照操作规程，双人核对，防止误操作。系统切换制定详细方案，分步实施，确保平稳过渡。配备应急备用系统，可随时恢复旧系统。施工期间加强与运营单位沟通协调，确保安全。安全检查8次，均为合格。应急演练4次，应急响应能力良好。',
                'progressPaymentDetails' => '合同总价1485万元。已按项目进度支付工程款891万元，占合同总价60%。首期款20%计297万元在合同签订后支付。第二期款30%计445.5万元在设备到货后支付。第三期款30%计445.5万元在安装调试完成40%后支付，已支付178.2万元。第四期款15%计222.75万元将在验收合格后支付。质保金5%计74.25万元在质保期5年满后支付。各期付款经过严格验收，凭证齐全，无拖欠工程款。',
                'changeOrderDetails' => '项目实施中发生4次变更。变更一：增加列车自动驾驶(ATO)功能，增加费用120万元。变更二：增加乘客信息系统(PIS)接口，增加费用35万元。变更三：信号机柜增加温湿度监控功能，增加费用18万元。变更四：增加车站应急后备模式，增加费用28万元。所有变更均经过地铁公司审批，并报行业主管部门备案。变更费用合计201万元，调整后合同总价1686万元。变更资料齐全，手续完备。',
                'supervisionDetails' => '监理单位为广东省轨道交通工程监理公司，派驻总监1名、专业监理工程师2名。监理人员具有丰富的轨道交通信号系统监理经验，熟悉相关标准规范。监理工作认真负责，全程参与设备验收、安装监督、调试见证、测试验收等环节。每周召开工地例会，协调解决技术和安全问题。累计发出监理工程师通知14份，提出问题和改进建议，整改及时有效。审核施工方案、测试方案等文档12份。编制监理月报6份，监理日志详细完整。监理工作得到地铁公司和行业主管部门认可。',
            ],
        ];

        foreach ($constructionImplementations as $data) {
            // Find the project by name
            $project = $projectRepo->findOneBy(['projectName' => $data['projectName']]);

            if (!$project) {
                continue; // Skip if project not found
            }

            $constructionImplementation = new ConstructionImplementation();
            $constructionImplementation->setProject($project);
            $constructionImplementation->setStartDate(new \DateTimeImmutable($data['startDate']));
            $constructionImplementation->setCompletionDate(new \DateTimeImmutable($data['completionDate']));
            $constructionImplementation->setConstructionProgressDetails($data['constructionProgressDetails']);
            $constructionImplementation->setQualityInspectionDetails($data['qualityInspectionDetails']);
            $constructionImplementation->setSafetyInspectionDetails($data['safetyInspectionDetails']);
            $constructionImplementation->setProgressPaymentDetails($data['progressPaymentDetails']);
            $constructionImplementation->setChangeOrderDetails($data['changeOrderDetails']);
            $constructionImplementation->setSupervisionDetails($data['supervisionDetails']);

            $manager->persist($constructionImplementation);
        }

        $manager->flush();
    }
}
