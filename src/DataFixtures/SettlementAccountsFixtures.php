<?php

declare(strict_types=1);

namespace App\DataFixtures;

use App\Entity\Project;
use App\Entity\SettlementAccounts;
use Doctrine\Bundle\FixturesBundle\Fixture;
use Doctrine\Common\DataFixtures\DependentFixtureInterface;
use Doctrine\Persistence\ObjectManager;

class SettlementAccountsFixtures extends Fixture implements DependentFixtureInterface
{
    public function getDependencies(): array
    {
        return [
            CompletionAcceptanceFixtures::class,
        ];
    }

    public function load(ObjectManager $manager): void
    {
        $projectRepo = $manager->getRepository(Project::class);

        // Define settlement accounts for all 10 projects
        $settlementAccounts = [
            [
                'projectName' => '智慧城市数据平台建设项目',
                'settlementDate' => '2026-12-20',
                'contractSettlementDetails' => '项目工程结算已完成。合同总价553万元（原合同价498万元，变更增加55万元）。结算审核认定工程价款553万元，与合同价一致，无增减。结算明细包括：硬件设备采购210万元，软件开发258万元，系统集成45万元，机房建设40万元。变更工程55万元包括：数据备份系统容量扩容18万元，移动端APP开发25万元，UPS容量提升12万元。所有变更均已履行审批程序，变更签证手续齐全。结算资料包括合同文件、变更签证、工程量清单、价格确认单、验收证明等，资料齐全完整。',
                'costAuditDetails' => '造价审核由北京中正工程咨询有限公司进行。审核时间为2026年12月5-18日，历时14天。审核内容包括合同价款、变更价款、工程量核定、价格核对等。审核结论：送审价553万元，审定价553万元，审减0元，审减率0%。审核认为工程量真实准确，价格合理合规，变更手续完备，结算资料齐全，同意按553万元进行结算。审核报告已提交建设单位，建设单位已确认。',
                'quantitySurveyDetails' => '工程量核定工作认真细致。成立工程量核定小组，由建设单位、施工单位、监理单位、造价咨询单位共同参与。核定内容包括：硬件设备数量和规格，软件开发功能模块和代码量，系统集成工作量，机房建设面积和设备安装。核定方法采用现场核查、资料审核、技术确认相结合。核定结果：硬件设备到货清单齐全，数量规格与合同一致；软件功能模块全部完成，代码量符合工作量评估；系统集成工作按计划完成；机房建设面积准确，设备安装到位。工程量核定结果真实准确，各方签字确认。',
                'disputeResolutionDetails' => '结算过程中发生争议2项，均已妥善解决。争议一：关于移动端APP功能范围和计价方式。施工单位认为部分功能超出原合同范围，应按工日计价；建设单位认为属于原合同范围，不应增加费用。经协商，确定新增功能模块按工日计价，计25万元。争议二：关于系统测试工作量认定。双方对测试工日数存在分歧。经监理单位协调，审查测试记录，确定测试工作量，已包含在合同价中，不另行计价。争议解决过程公平公正，协商记录完整，双方签字认可。',
                'paymentCompletionDetails' => '工程款支付已全部完成。合同总价553万元，已支付528.35万元，留质保金5%计27.65万元。支付明细：首期款30%计149.4万元已支付，第二期款40%计199.2万元已支付，第三期款25%计124.5万元已支付，第四期款4.75%计26.27万元已支付，其余28.98万元已支付，累计已支付95%。质保金27.65万元将在质保期2年满后支付。所有支付均经过严格审核，支付凭证齐全，无拖欠工程款。施工单位对支付情况无异议。',
                'warrantyManagementDetails' => '质保金管理规范。质保金金额27.65万元，占合同价5%，质保期2年，从2026年11月28日验收合格之日起计算，至2028年11月27日止。质保期内，施工单位负责系统的免费维护和缺陷修复。建设单位建立质保金台账，明确质保金额、质保期限、返还条件。质保期内系统运行稳定，发现小问题5项，施工单位及时处理，服务态度良好。质保期满后，建设单位将组织质保期满检查，确认无遗留问题后，在30日内返还质保金。质保金不计利息。',
            ],
            [
                'projectName' => '东城区市政道路改造工程',
                'settlementDate' => '2026-12-28',
                'contractSettlementDetails' => '工程结算已完成。合同总价1208.5万元（原合同价1185万元，变更签证增加23.5万元）。结算审核认定工程价款1195万元，核减13.5万元，核减率1.1%。结算明细：路面工程实际完成735万元（送审750万元，核减15万元），人行道工程180万元，管网工程120万元，照明工程85万元，绿化工程50万元（送审48.5万元，核增1.5万元），其他25万元。核减主要原因是路面厚度部分不足、局部工程量计算有误。核增原因是补植树木数量增加。结算资料齐全，包括竣工图、工程量清单、隐蔽工程验收记录、材料价格确认单等。',
                'costAuditDetails' => '造价审核由北京市政工程造价事务所进行。审核时间为2026年12月10-26日，历时17天。审核人员实地查勘，核对图纸，复核工程量，审查价格。审核结论：送审价1208.5万元，审定价1195万元，核减13.5万元，核减率1.1%。核减项目主要是路面工程，经钻芯取样检测，部分路段厚度不足设计要求，按实际厚度计算；局部人行道面积计算重复，予以扣除。审核报告详细列明核减原因和依据，建设单位和施工单位均已确认。',
                'quantitySurveyDetails' => '工程量核定采用现场实测和图纸复核相结合的方法。道路工程实测长度14.85公里（合同15公里），因线位微调实际长度略少；路面面积按实际铺设面积计算，经测量为35.64万平方米；人行道实测面积5.78万平方米；雨水管道实测8.12公里，污水管道实测7.95公里，部分管道实际长度略少于设计长度；路灯实际安装792盏，少于合同800盏，因实际点位优化；绿化面积实测12.5万平方米，大于合同12万平方米。核定结果经各方签字确认。',
                'disputeResolutionDetails' => '结算中发生争议3项。争议一：路面厚度不足如何计价。经检测，约5%路段厚度不足1-2cm。经协商，按厚度比例扣减价款。争议二：变更签证中地下管线处理费用。施工单位认为应增加费用，建设单位认为应由施工单位自行处理。经监理协调，确认为不可预见费用，按实计算，核增8.5万元。争议三：绿化补植树木计价。经核实，因成活率问题补植树木120棵，经协商按合同价计算，核增1.5万元。所有争议均通过协商解决，未进入仲裁或诉讼程序。',
                'paymentCompletionDetails' => '工程款支付已基本完成。审定价1195万元，已支付1135.25万元，留质保金5%计59.75万元。支付明细：按进度已支付1074.5万元，竣工验收后支付尾款60.75万元，累计支付95%。质保金59.75万元将在质保期2年满后支付。所有支付手续完备，支付及时，无拖欠农民工工资情况。施工单位出具工程款结清承诺书，承诺除质保金外工程款已全部结清，无拖欠分包和材料供应商款项。',
                'warrantyManagementDetails' => '质保金59.75万元，质保期2年，自2026年11月25日起计算。质保期内，施工单位负责工程维修和缺陷修复。建设单位建立质保金专户管理，设立质保金台账。质保期内，道路发现小面积破损3处、井盖下沉2处，施工单位均及时修复，质量良好。路灯故障5次，及时更换维修。绿化养护到位，树木成活率保持95%以上。施工单位养护服务良好。质保期满后，组织专项检查，确认无遗留问题后返还质保金。',
            ],
            [
                'projectName' => '企业园区智能安防系统',
                'settlementDate' => '2026-10-20',
                'contractSettlementDetails' => '项目结算已完成。合同总价365万元（原合同348万元，变更增加17万元）。结算审核认定工程价款365万元，与合同价一致。结算明细：摄像头设备及安装154.8万元（原合同150万元，变更增加4.8万元），门禁系统58.5万元（原合同52万元，变更增加6.5万元），报警系统38万元，监控中心设备51.2万元（原合同48万元，变更增加3.2万元），线缆材料37.5万元（原合同35万元，变更增加2.5万元），安装调试25万元。所有变更均经过审批，手续齐全。设备数量、规格经现场核对，与合同及变更一致。',
                'costAuditDetails' => '造价审核由上海华建工程咨询有限公司进行。审核时间为2026年10月8-18日，历时11天。审核方法采用资料审核和现场核查相结合。审核结论：送审价365万元，审定价365万元，无增减。审核认为设备价格合理，参考市场价格和历史价格，价格公允；工程量真实准确，现场核对设备数量、规格与清单一致；变更手续齐全，变更价格合理；安装费用按定额标准计算，准确无误。审核过程规范，审核报告详实，建设单位认可。',
                'quantitySurveyDetails' => '工程量核定工作细致全面。核定小组对全部设备进行现场清点核对。核定结果：摄像头320个，其中高清半球190个、高清枪机130个，规格型号与合同一致；门禁系统68套，包括读卡器136个、控制器68个、电锁68个；报警探测器156个，包括红外探测器86个、门磁70个；周界报警200米；监控中心拼接屏34块（原合同30块，变更增加4块）；线缆总长度28450米，略多于设计长度。所有设备功能正常，满足使用要求。核定资料各方签字认可。',
                'disputeResolutionDetails' => '结算过程顺利，仅发生争议1项。争议内容：关于线缆长度计价问题。施工单位认为实际线缆用量28450米，应按实际用量计价；建设单位认为设计用量28000米，超出部分属于施工损耗，不应计价。经监理协调，审查施工记录和领料记录，确认实际用量合理，超出450米主要是局部路由调整所致，经协商按实际用量计价，增加费用0.5万元，已包含在合同价中。争议解决公平合理，双方满意。',
                'paymentCompletionDetails' => '工程款支付已全部完成。合同总价365万元，已支付346.75万元，留质保金5%计18.25万元。支付明细：首期30%计104.4万元已支付，第二期30%计104.4万元已支付，第三期30%计104.4万元已支付，第四期10%计36.5万元已验收后支付，减去质保金后实际支付346.75万元，支付比例95%。质保金18.25万元将在质保期3年满后支付。所有支付凭证齐全，支付及时，无拖欠款项。施工单位出具结算清单，确认工程款已结清。',
                'warrantyManagementDetails' => '质保金18.25万元，质保期3年，自2026年9月25日验收合格起计算，至2029年9月24日止。质保期内，施工单位提供免费维护服务，包括设备故障维修、软件升级、技术支持等。建设单位建立维护服务记录，记录每次服务内容和质量。质保期内，发生设备故障8次，主要是摄像头故障5次、门禁系统故障2次、监控中心设备故障1次，施工单位均在24小时内响应，及时维修更换，服务态度好，维修质量高。软件系统升级2次，功能优化，运行更稳定。质保服务满意。',
            ],
            [
                'projectName' => '水利枢纽工程建设',
                'settlementDate' => '2028-06-30',
                'contractSettlementDetails' => '工程结算已全面完成。合同总价8.3亿元（概算7.85亿元，变更增加4500万元）。结算审核认定工程价款8.15亿元，核减1500万元，核减率1.8%。结算明细：土石方开挖填筑2.95亿元，混凝土工程2.48亿元，基础处理0.92亿元，金属结构及机电设备1.25亿元，建筑工程0.35亿元，其他0.20亿元。核减主要原因：部分土石方工程量计算偏大，核减800万元；部分基础处理工程效果良好、灌浆量减少，核减500万元；材料价差调整核减200万元。变更工程包括基础处理方案优化、泄洪洞支护加强、混凝土配合比优化等，变更手续齐全。',
                'costAuditDetails' => '造价审核由水利部综合事业局委托的国家水利工程造价总站进行。审核历时3个月，2028年4月-6月。审核组由15名造价工程师组成，分为土建、机电、金属结构三个专业组。审核采用全面审核方式，实地查勘，复核工程量，审查单价，核对价格调整。审核结论：送审价8.3亿元，审定价8.15亿元，核减1500万元，核减率1.8%。核减主要是工程量核减和价差调整。审核报告详细，附有核减明细表和依据说明。审核结果经建设单位、施工单位确认。',
                'quantitySurveyDetails' => '工程量核定工作量大面广，历时2个月。成立工程量核定组,由建设单位、施工单位、监理单位、设计单位、造价咨询单位组成，共30余人。核定方法采用断面测量、体积计算、图纸复核、现场实测相结合。核定结果：土石方开挖698万立方米（合同估算720万立方米），实际略少；混凝土浇筑67.5万立方米（合同68万立方米），实际略少；帷幕灌浆8.2万米（合同预计10万米），实际灌浆量少，说明地质条件好于预期；金属结构安装4200吨，与合同一致。核定过程严谨，资料详实，各方签字认可。',
                'disputeResolutionDetails' => '结算中发生重大争议5项，经协商解决。争议一：关于基础处理单价，施工单位认为地质条件复杂应提高单价，建设单位认为应按合同价。经专家论证，确定部分复杂地段提高单价，核增600万元。争议二：关于混凝土价差调整，双方对调整时点和幅度存在分歧。经审查合同条款和市场价格，确定调整方式，核减200万元。争议三：关于土石方分类，施工单位认为石方比例高，建设单位认为土方多。经复核地质资料和爆破记录，确定土石比例，影响金额500万元。争议四：关于工期延误责任，涉及索赔1200万元。经分析延误原因，确定建设单位原因50%、施工单位原因30%、不可抗力20%，最终核定索赔600万元。争议五：关于变更价款计算方式，分歧较大。经多次协商谈判，达成一致意见。所有争议均通过协商解决，未进入诉讼仲裁。',
                'paymentCompletionDetails' => '工程款支付已基本完成。审定价8.15亿元，已支付7.7425亿元，留质保金10%计0.815亿元（8150万元）。支付情况：按月进度支付累计7.34亿元，验收后支付尾款0.4025亿元，合计支付95%。质保金8150万元将在质保期3年满后支付。支付程序规范，每次支付均经计量、审核、批准。支付凭证完整，无拖欠农民工工资。施工单位出具债权债务确认书，确认除质保金外工程款已全部结清，无拖欠分包单位、材料供应商款项，无工程欠款纠纷。',
                'warrantyManagementDetails' => '质保金8150万元，占工程价款10%，质保期3年，自2028年3月15日起计算。质保期内，施工单位负责工程缺陷修复和维护。建设单位设立质保金专户，单独核算。质保期首年进行蓄水运行观测，大坝变形、渗流等监测数据正常。第二年开展安全鉴定，各项安全指标满足要求。质保期内发现缺陷23项，包括局部渗水5处、止水带损坏3处、闸门漏水2处、机组振动偏大1处等，施工单位均按期修复，质量良好。质保期满后组织专项检查验收，确认工程质量可靠，缺陷已全部修复，同意返还质保金。',
            ],
            [
                'projectName' => '商业综合体建筑工程',
                'settlementDate' => '2028-11-15',
                'contractSettlementDetails' => '工程结算已完成。合同总价2.61亿元（原合同2.45亿元，变更增加1600万元）。结算审核认定工程价款2.58亿元，核减300万元，核减率1.2%。结算明细：土建工程1.33亿元（送审1.35亿元），幕墙工程0.41亿元（送审0.42亿元），装修工程0.48亿元，机电安装0.28亿元，其他0.08亿元。核减原因主要是：部分土建工程量计算重复，核减150万元；幕墙面积测量偏差，核减100万元；装修部分材料品牌替换核减50万元。变更工程1600万元包括地下室底板加厚180万元、幕墙升级350万元、机电优化280万元、精装修提标420万元、其他370万元，变更手续齐全。',
                'costAuditDetails' => '造价审核由深圳市建设工程造价管理站委托的造价咨询公司进行。审核时间为2028年9月-11月，历时2.5个月。审核组由12名造价工程师组成，分土建、幕墙、装修、机电四个专业。审核方法采用全面审核与重点抽查相结合。审核结论：送审价2.61亿元，审定价2.58亿元，核减300万元，核减率1.2%，控制良好。审核发现工程量计算基本准确，仅个别部位有误；单价套用合理，材料价格公允；变更手续完备，价格合理。审核报告详细规范，附工程量对比表、核减明细表。审核结果各方认可。',
                'quantitySurveyDetails' => '工程量核定工作全面细致。核定小组采用分专业核对方式。土建工程核定：混凝土工程量8.38万立方米（送审8.5万立方米），经复核CAD图纸，扣除重复计算部分；钢筋工程量1.18万吨（送审1.2万吨），复核料单和现场实际用量。幕墙工程核定：玻璃幕墙面积4.42万平方米（送审4.5万平方米），经现场实测修正。装修工程核定：装修面积17.8万平方米（送审18万平方米），扣除设备用房等不装修区域。机电工程核定：空调系统、给排水系统、电气系统按实际安装数量和系统图核对，与合同基本一致。核定过程严谨，各方参与，结果准确。',
                'disputeResolutionDetails' => '结算中发生争议4项。争议一：地下室底板加厚变更价款。施工单位报价200万元，建设单位认为高估，应为160万元。经造价咨询，核定180万元。争议二：幕墙材料品牌变更差价。原合同品牌A，实际采用品牌B，价格相差。经市场询价和合同条款分析，核定差价350万元。争议三：精装修部分材料替换。施工单位认为应按原品牌计价，建设单位认为实际采用品牌降低应核减。经协商，按实际品牌市场价计算，核减50万元。争议四：施工过程中临时用电、用水费用分摊。经协商，按合同约定由施工单位承担。所有争议经多轮协商达成一致，未影响工程款支付。',
                'paymentCompletionDetails' => '工程款支付已基本完成。审定价2.58亿元，已支付2.451亿元，留质保金5%计0.129亿元（1290万元）。支付明细：按月进度支付累计2.322亿元，验收后支付尾款0.129亿元，合计支付95%。所有支付手续完备，包括施工单位申请、监理审核、造价咨询复核、建设单位批准。支付凭证齐全，银行转账记录清晰。无拖欠农民工工资，农民工工资实名制发放，专户管理。施工单位提供总包单位和分包单位款项结清证明，确认无拖欠，无纠纷。',
                'warrantyManagementDetails' => '质保金1290万元，质保期2年，自2028年8月20日起计算。质保期内，施工单位负责工程保修。建筑工程主体结构保修50年，屋面防水5年，装修2年，机电设备按产品质保期。建设单位建立报修制度，施工单位建立维修响应机制。质保期内，发现问题38项，主要是装修收口瑕疵18处、门窗调整12处、机电设备故障5处、其他3处。施工单位维修及时，整改彻底，服务态度好。业主满意度高。质保期满后组织专项检查，确认无遗留问题后返还质保金。',
            ],
            [
                'projectName' => '环境治理信息化平台',
                'settlementDate' => '2027-05-10',
                'contractSettlementDetails' => '工程结算已完成。合同总价561万元（原合同415万元，变更增加146万元）。结算审核认定工程价款555万元，核减6万元，核减率1.1%。结算明细：监测设备采购及安装255万元（送审258万元），网络建设45万元，数据中心建设80万元（送审82万元），软件开发126万元，安装调试49万元（送审50万元）。核减原因：监测设备部分备品备件未到货核减3万元，数据中心机柜数量略少核减2万元，调试工作量略少核减1万元。变更工程146万元包括增加监测站点、增加移动监测车、扩容存储、增加移动应用等，变更均已审批。',
                'costAuditDetails' => '造价审核由浙江省环境工程咨询中心进行。审核时间2027年4月20-5月8日，历时19天。审核内容包括设备价格、工程量、安装费用等。审核结论：送审价561万元，审定价555万元，核减6万元，核减率1.1%。审核认为设备价格合理，参考政府采购价格和市场价格；工程量基本准确，个别设备数量略有差异；软件开发工作量合理，功能模块完整；安装调试费用按定额计算准确。审核报告规范，审核依据充分，建设单位和施工单位均认可。',
                'quantitySurveyDetails' => '工程量核定工作专业细致。核定内容：监测设备数量规格，现场逐一清点，大气监测站18座（合同15+变更3）、水质监测站10座、噪声监测点30个、视频监控点50个、移动监测车1辆，设备清单与合同及变更一致；网络设备交换机28台、路由器5台、防火墙2台，与设计一致；数据中心服务器8台、存储4套、UPS 2套，配置满足需求；软件系统功能模块，按需求规格说明书核对，全部开发完成，代码量符合预估。核定采用清单核对、现场查验、功能测试相结合的方法，核定结果准确可靠。',
                'disputeResolutionDetails' => '结算过程中发生争议2项。争议一：监测设备备品备件问题。合同约定提供10%备品备件，实际部分备件未到货。施工单位承诺后续补齐，建设单位要求扣款。经协商，扣减3万元，备件到货后补付。争议二：软件开发工作量认定。施工单位认为某些功能超出原需求，应增加费用；建设单位认为属于需求范围内，不应增加。经监理协调，审查需求文档和变更记录，确认为需求变更，已包含在变更价格中，不再增加。双方对解决方案认可，未影响结算进度。',
                'paymentCompletionDetails' => '工程款支付已全部完成。审定价555万元，已支付527.25万元，留质保金5%计27.75万元。支付明细：首期20%计83万元已支付，第二期30%计124.5万元已支付，第三期30%计166.5万元已支付（含变更部分），第四期15%计83.25万元验收后已支付，减去质保金后累计支付95%。质保金27.75万元将在质保期3年满后支付。支付手续完备，包括监测设备到货验收单、软件验收报告、系统测试报告、验收证书等。无拖欠款项，施工单位出具结算确认函。',
                'warrantyManagementDetails' => '质保金27.75万元，质保期3年，自2027年4月10日起计算。质保期内，施工单位提供免费维护服务。监测设备质保，设备故障免费维修更换，每年免费校准检定1次；软件系统质保，免费技术支持，免费BUG修复，免费小版本升级；网络系统质保，设备故障免费维修。建设单位建立维护服务台账。质保期内，监测设备故障12次，主要是传感器漂移、通信模块故障，施工单位及时响应维修；软件BUG 8个，及时修复；系统升级3次，功能优化。维护服务及时专业，系统运行稳定。',
            ],
            [
                'projectName' => '高速公路交通工程',
                'settlementDate' => '2029-12-20',
                'contractSettlementDetails' => '工程结算已全面完成。合同总价44.8亿元（概算44.5亿元，变更增加3000万元）。结算审核认定工程价款44.2亿元，核减6000万元，核减率1.3%。结算明细：路基路面工程27.5亿元（送审28亿元），桥梁工程8.3亿元（送审8.5亿元），隧道工程5.6亿元（送审5.8亿元），交通工程1.5亿元，绿化及其他1.3亿元。核减原因：路基土石方工程量核减、路面厚度局部不足、桥梁部分钢材计算偏大、隧道支护工程量略少等。变更工程3000万元主要是地质条件变化导致的设计变更、工程优化等，变更程序合规。',
                'costAuditDetails' => '造价审核由交通运输部公路科学研究院委托的专业造价咨询机构进行。审核历时4个月，2029年9月-12月。审核组由25名高级造价工程师组成，分路基路面、桥梁、隧道、交通工程四个专业组。审核采用全面审核方式，实地踏勘120公里，复核图纸，核对工程量，审查单价和价差调整。审核结论：送审价44.8亿元，审定价44.2亿元，核减6000万元，核减率1.3%，造价控制优秀。审核报告系统全面，共计800余页，附详细核减明细和依据说明。审核结果经建设单位、施工单位、监理单位、设计单位确认。',
                'quantitySurveyDetails' => '工程量核定工作量大，历时3个月。核定组50余人，采用分段分项核定方式。核定方法：路基路面工程采用断面测量、体积计算、图纸复核；桥梁工程采用结构尺寸实测、钢筋料单核对、混凝土方量计算；隧道工程采用断面测量、衬砌方量计算、超欠挖统计；交通工程采用设施清点、系统测试。核定结果：土石方2230万立方米（合同2250万立方米），实际略少；混凝土44.5万立方米（合同45万立方米）；沥青路面77万吨（合同78万吨）；桥梁45座总长8500米；隧道8座总长7200米，与合同一致。核定资料详实，各方签字确认。',
                'disputeResolutionDetails' => '结算中发生重大争议8项，经协商和专家调解解决。争议一：关于路基土石方分类比例，涉及金额2000万元。经地质复核和爆破记录审查，确定分类比例，核减800万元。争议二：关于桥梁钢筋工程量，施工单位按料单计算，建设单位按图纸计算，差异500吨。经复核，确定按实际用量扣除损耗计算，核减300万元。争议三：关于隧道超挖处理，超挖部分如何计价存在争议。经专家论证，确定计价办法，核增400万元。争议四：关于工期延误索赔，施工单位索赔2500万元。经责任分析，确定建设单位承担40%，核定索赔1000万元。争议五：关于材料价差调整时点和幅度，分歧较大。经审查合同条款和市场价格，确定调整方案。争议六至八：涉及工程质量、工程变更、签证等，均通过协商解决。所有争议解决公平合理，各方接受。',
                'paymentCompletionDetails' => '工程款支付已基本完成。审定价44.2亿元，已支付41.99亿元，留质保金10%计4.42亿元。支付情况：按月进度累计支付39.78亿元，验收后支付尾款2.21亿元，合计支付95%。支付程序规范，每月计量、审核、批准，支付凭证齐全。无拖欠农民工工资，农民工实名制管理，工资专户发放。施工单位出具工程款结算确认书，确认除质保金外工程款已全部结清，无拖欠分包、供应商款项，无经济纠纷。建设单位出具支付证明，确认支付完成。',
                'warrantyManagementDetails' => '质保金4.42亿元，占工程价款10%，质保期3年，自2029年9月30日起计算。质保期内，施工单位负责工程养护和缺陷修复。路面工程质保2年，桥梁隧道主体结构50年，交通设施2年。施工单位成立专门养护队伍，配备人员和设备。建设单位建立巡查制度，定期检查。质保期内，路面小面积破损修补28处，桥梁伸缩缝更换5道，隧道渗水处理6处，护栏修复15处，标志标线维护多次，绿化补植养护持续进行。施工单位养护及时，质量可靠。质保期满组织专项验收，确认工程质量良好，缺陷修复彻底，同意返还质保金。',
            ],
            [
                'projectName' => '智慧医疗信息系统升级',
                'settlementDate' => '2027-05-15',
                'contractSettlementDetails' => '工程结算已完成。合同总价915万元（原合同675万元，变更增加240万元）。结算审核认定工程价款905万元，核减10万元，核减率1.1%。结算明细：软件开发520万元（送审528万元），硬件设备采购218万元，系统集成85万元，培训服务58万元（送审60万元），其他24万元（送审26万元）。核减原因：软件开发部分模块工作量略少核减8万元，培训天数略少核减2万元。变更工程240万元包括移动医护系统45万元、患者自助系统38万元、远程会诊系统52万元、大数据平台68万元、服务器升级25万元、培训增加12万元，变更均经审批。',
                'costAuditDetails' => '造价审核由四川省信息工程造价咨询中心进行。审核时间2027年4月25-5月12日，历时18天。审核内容包括软件开发工作量、硬件设备价格、系统集成费用等。审核方法采用代码行数统计、功能点评估、市场价格对比、定额标准套用相结合。审核结论：送审价915万元，审定价905万元，核减10万元，核减率1.1%。审核认为软件开发工作量基本合理，代码质量高；硬件设备价格公允，参考政府采购价；系统集成费用合理；培训服务工作量略少。审核报告专业规范，审核依据充分，各方认可。',
                'quantitySurveyDetails' => '工程量核定专业细致。软件开发工作量核定采用功能点分析法和代码行数统计法相结合。核定结果：电子病历系统代码8.5万行，医嘱管理系统5.2万行，护理管理系统4.8万行，移动医护系统6.3万行，患者自助系统4.5万行，远程会诊系统5.8万行，大数据平台9.2万行，接口开发2.5万行，合计46.8万行代码（送审48万行），略少于送审量。硬件设备清点：服务器8台、存储4套、网络设备22台、UPS 2套，与合同一致。系统集成工作量按实际接口数量和测试工作量核定，与合同基本相符。培训服务实际完成58天（送审60天），略少。',
                'disputeResolutionDetails' => '结算中发生争议3项。争议一：软件开发工作量评估方法。施工单位主张按工日法评估，建设单位主张按功能点法。经协商，采用两种方法综合评估，取平均值。争议二：远程会诊系统是否属于原合同范围。施工单位认为属于新增，建设单位认为属于原有功能扩展。经审查需求文档，确认为新增功能，计入变更。争议三：培训服务工作量。施工单位认为完成60天，建设单位认为实际58天。经核对培训签到表和记录，确认为58天。所有争议通过协商解决，过程公平，结果合理。',
                'paymentCompletionDetails' => '工程款支付已全部完成。审定价905万元，已支付859.75万元，留质保金5%计45.25万元。支付明细：首期20%计135万元已支付，第二期30%计202.5万元已支付，第三期30%计271.5万元已支付（含变更），第四期15%计135.75万元验收后已支付，加上其他支付115万元，累计支付95%。质保金45.25万元将在质保期3年满后支付。支付手续齐全，包括软件验收报告、硬件到货验收单、集成测试报告、培训签到表、卫健委验收证书等。无拖欠款项，施工单位出具款项结清函。',
                'warrantyManagementDetails' => '质保金45.25万元，质保期3年，自2027年4月20日起计算。质保期内，施工单位提供全方位技术支持和维护服务。软件系统质保：免费BUG修复，免费小版本升级，7×24小时技术支持热线，故障响应时间不超过2小时，重大问题现场支持；硬件设备质保：服务器、存储等核心设备5年厂商质保，网络设备3年质保，故障设备免费维修或更换；系统培训：每年提供2次免费培训，培训新员工操作使用。建设单位建立服务工单系统。质保期内，软件BUG修复25个，系统升级5次，硬件故障维修8次，培训6场次。服务响应及时，处理专业，用户满意度95%以上。',
            ],
            [
                'projectName' => '产业园区基础设施建设',
                'settlementDate' => '2027-09-05',
                'contractSettlementDetails' => '工程结算已完成。合同总价3596万元（原合同3450万元，变更增加146万元）。结算审核认定工程价款3560万元，核减36万元，核减率1.0%。结算明细：道路工程1555万元（送审1580万元），给排水工程810万元（送审820万元），电力工程485万元，通信工程268万元，燃气工程228万元（送审235万元），绿化工程214万元（送审208万元）。核减原因：道路工程量测算偏大核减25万元，给排水管道长度略短核减10万元，燃气管道局部未施工核减7万元。核增原因：绿化面积增加核增6万元。变更工程146万元包括路灯增加、绿化增加、管径调整等，变更手续齐全。',
                'costAuditDetails' => '造价审核由湖北省工程造价协会推荐的造价咨询公司进行。审核时间2027年8月18-9月3日，历时17天。审核组8人，分道路、管网、电力通信、绿化四个专业。审核方法采用实地测量、图纸复核、清单核对、市场询价相结合。审核结论：送审价3596万元，审定价3560万元，核减36万元，核减率1.0%，造价控制良好。审核认为工程量基本准确，个别部位测算有误；单价套用合理，材料价格公允；变更手续完备，价格合理。审核报告规范详细，附核减明细表和测算依据，各方认可。',
                'quantitySurveyDetails' => '工程量核定采用专业测量和图纸复核相结合。道路工程实测：道路长度9.85公里（合同10公里），因实际线位微调略短；路面面积23.6万平方米；人行道5.6万平方米。给排水工程实测：给水管道9.8公里（合同10公里），排水管道雨污各9.7公里（合同各10公里），管道略短因实际路由优化。电力工程核对：电力电缆15.2公里（合同15公里），略长因局部路由调整；开闭所2座与合同一致。通信管道12公里与合同一致。燃气管道实测7.7公里（合同8公里），部分路段暂未接入。绿化面积实测15.3万平方米（合同15万平方米），略多。核定过程严谨，各方现场确认。',
                'disputeResolutionDetails' => '结算中发生争议3项。争议一：道路工程量差异问题。施工单位认为按设计长度计价，建设单位认为按实际长度。经协商，确定按实际完成工程量计价，核减25万元。争议二：排水管道管径变更价差。部分管道由DN600变更为DN800，单价不同。经审查变更手续和市场价格，确定价差，已计入变更价格。争议三：绿化补植计价。原合同12万平方米，实际完成15.3万平方米，增加部分如何计价。经协商，按变更价格计算，核增6万元。所有争议通过平等协商解决，各方满意，未影响结算进度。',
                'paymentCompletionDetails' => '工程款支付已全部完成。审定价3560万元，已支付3382万元，留质保金5%计178万元。支付明细：按月进度支付累计3204万元，验收后支付尾款178万元，合计支付95%。支付手续完备，每次支付经计量、审核、批准。支付凭证齐全，银行流水清晰。无拖欠农民工工资，工资按月足额发放，专户管理。施工单位出具工程款结清承诺，确认除质保金外工程款已全部结清，无拖欠分包和供应商款项，无工程欠款纠纷。建设单位出具支付证明，双方无争议。',
                'warrantyManagementDetails' => '质保金178万元，质保期2年，自2027年8月5日起计算。质保期内，施工单位负责工程保修和养护。道路质保：路面养护、破损修补、裂缝处理、井盖维护等。管网质保：管道漏水维修、井室维护、设施维修等。电力通信质保：设施维修、设备维护等。绿化质保：苗木养护、补植、修剪、病虫害防治等。施工单位配备养护人员和设备，定期巡查养护。建设单位建立报修制度。质保期内，道路修补18处，管网维修5次，电力通信维护3次，绿化养护持续进行，苗木成活率保持95%以上。养护及时到位，质量良好。质保期满检查确认无遗留问题后返还质保金。',
            ],
            [
                'projectName' => '轨道交通信号系统改造',
                'settlementDate' => '2027-07-05',
                'contractSettlementDetails' => '工程结算已完成。合同总价1686万元（原合同1485万元，变更增加201万元）。结算审核认定工程价款1680万元，核减6万元，核减率0.36%。结算明细：信号设备采购955万元（送审958万元），安装调试386万元，系统集成224万元（送审225万元），测试验收82万元，其他33万元（送审35万元）。核减原因：设备备品备件部分未到货核减3万元，系统集成部分接口工作量略少核减1万元，测试天数略少核减2万元。变更工程201万元包括列车自动驾驶ATO功能120万元、乘客信息系统接口35万元、信号机柜监控18万元、车站应急后备模式28万元，变更经审批，手续齐全。',
                'costAuditDetails' => '造价审核由广东省轨道交通工程造价管理站委托的专业机构进行。审核时间2027年6月18-7月3日，历时16天。审核组由8名轨道交通专业造价工程师组成。审核内容包括设备价格、安装费用、系统集成费用、测试费用等。审核方法采用市场询价、历史价格对比、定额套用、专家评估相结合。审核结论：送审价1686万元，审定价1680万元，核减6万元，核减率0.36%，造价控制优秀。审核认为设备价格合理，略低于市场价；安装费用按定额计算准确；系统集成费用合理；测试费用略高。审核报告专业详细，各方认可。',
                'quantitySurveyDetails' => '工程量核定专业严谨。设备数量核定：信号设备按站核对，36个车站逐一清点。核定结果：室内信号设备36套、室外信号设备72套、轨道电路156套、应答器288个、列车自动驾驶车载设备90套（30列车×3节），与合同及变更一致；信号电缆125公里（合同120公里），略多因路由调整；光缆80公里与合同一致。安装工作量按设备数量和安装定额核定，基本相符。系统集成工作量按接口数量和调试工作量核定，接口85个（送审90个），实际略少。测试工作量按测试用例和测试天数核定，完成测试78天（送审80天），略少。核定过程严谨，资料齐全。',
                'disputeResolutionDetails' => '结算过程顺利，发生争议2项。争议一：ATO功能是否属于原合同范围。施工单位认为原合同仅包含基本控制功能，ATO属于新增；建设单位认为ATO应包含在信号系统内。经审查技术规范和合同条款，确认ATO为新增功能，计入变更价格120万元。争议二：测试工作量认定。施工单位报80天，建设单位认为实际78天。经核对测试记录和报告，确认78天，按实计算。双方对争议处理结果满意，协商过程友好，未影响结算。',
                'paymentCompletionDetails' => '工程款支付已全部完成。审定价1680万元，已支付1596万元，留质保金5%计84万元。支付明细：首期20%计297万元已支付，第二期30%计445.5万元已支付，第三期30%计504万元已支付（含变更），第四期15%计252万元验收后已支付，加上其他支付97.5万元，累计支付95%。质保金84万元将在质保期5年满后支付。支付手续齐全，包括设备到货验收单、安装记录、调试报告、测试报告、安全评估报告、验收证书等。无拖欠款项，施工单位出具结算确认函，确认款项已结清。',
                'warrantyManagementDetails' => '质保金84万元，质保期5年，自2027年6月5日起计算。质保期5年高于一般工程，体现轨道交通安全要求。质保期内，施工单位提供全面技术支持和维护服务。设备质保：信号设备故障免费维修，老化设备免费更换，每年免费预防性维护2次；软件质保：免费BUG修复，免费版本升级，兼容性适配；技术支持：7×24小时热线，故障响应30分钟，现场响应2小时，备品备件充足。建设单位建立设备运行台账和故障记录。质保期内，设备故障16次，主要是继电器故障、传感器漂移，均及时维修；软件升级8次，功能优化，兼容性改进。维护服务专业及时，系统运行安全稳定，故障率低于0.5%。',
            ],
        ];

        foreach ($settlementAccounts as $data) {
            // Find the project by name
            $project = $projectRepo->findOneBy(['projectName' => $data['projectName']]);

            if (!$project) {
                continue; // Skip if project not found
            }

            $settlement = new SettlementAccounts();
            $settlement->setProject($project);
            $settlement->setSettlementDate(new \DateTimeImmutable($data['settlementDate']));
            $settlement->setContractSettlementDetails($data['contractSettlementDetails']);
            $settlement->setCostAuditDetails($data['costAuditDetails']);
            $settlement->setQuantitySurveyDetails($data['quantitySurveyDetails']);
            $settlement->setDisputeResolutionDetails($data['disputeResolutionDetails']);
            $settlement->setPaymentCompletionDetails($data['paymentCompletionDetails']);
            $settlement->setWarrantyManagementDetails($data['warrantyManagementDetails']);

            $manager->persist($settlement);
        }

        $manager->flush();
    }
}
